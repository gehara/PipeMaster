x[3]
x<-ms(nsam=22, nreps=1, opts="-t 500 -r 2000 500")
x[3]
x<-ms(nsam=22, nreps=1, opts="-t 500 -r 2000 500")
theta<-runif(1,100,1000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000")
)
for(i in 1:1000){
theta<-runif(1,100,1000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,x[3])
table<-rbind(table,data)
}
theta<-runif(1,100,1000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,x[3])
data
strsplit(x[3]," ")[2]
strsplit(x[3]," ")
strsplit(x[3]," ")[[1]][1]
strsplit(x[3]," ")[[1]][2]
theta<-runif(1,100,1000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
table<-rbind(table,data)
data
table
tab<-NULL
for(i in 1:1000){
theta<-runif(1,100,1000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
1000000*4*500000*10e-9
1000000*4*500000*10e-10
theta<-runif(1,2000,2000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
x
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
1000000*4*5000000*10e-10
1000000*4*2000000*10e-10
theta<-runif(1,8000,8000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
1000000*4*100000*10e-10
1000000*4*500000*10e-10
theta<-runif(1,2000,2000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
1000000*4*500000*10e-9
1000000*4*100000*10e-9
1000000*4*100000*10e-9
theta<-runif(1,4000,4000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
1000000*4*200000*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
x
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
theta<-runif(1,8000,8000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
theta<-runif(1,8000,8000)
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
tab
data
tab<-NULL
for(i in 1:100){
theta<-runif(1,50000,500000)
theta<-1000000*4*theta*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(theta,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
theta<-1000000*4*Ne*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r 2000 1000"))
data<-c(Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
tab<-NULL
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
r<-4N*1
theta<-1000000*4*Ne*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
r<-4N*1
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
ar<-4N*1
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
r<-4*1
theta<-1000000*4*Ne*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
plot(tab[,1]~tab[,2])
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
r<-4*1
theta<-1000000*4*Ne*10e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
plot(tab[,1]~tab[,2])
plot(tab[,1]~tab[,3])
plot(tab[,2]~tab[,3])
?lm
abline(lm(tab[,2]~tab[,3]))
tab<-NULL
for(i in 1:100){
Ne<-runif(1,50000,500000)
r<-4*1
theta<-1000000*4*Ne*1e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
plot(tab[,2]~tab[,3])
tab<-NULL
for(i in 1:100){
Ne<-runif(1,100000,5000000)
r<-4*1
theta<-1000000*4*Ne*1e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
plot(tab[,2]~tab[,3])
abline(lm(tab[,2]~tab[,3]))
for(i in 1:500){
Ne<-runif(1,100000,5000000)
r<-4*1
theta<-1000000*4*Ne*1e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
tab<-rbind(tab,data)
print(i)
}
plot(tab[,2]~tab[,3])
abline(lm(tab[,2]~tab[,3]))
36000/1000000
tab<-NULL
for(i in 1:500){
Ne<-runif(1,100000,5000000)
r<-4*1
theta<-1000000*4*Ne*1e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta,))#"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
tab<-rbind(tab,data)
print(i)
}
tab<-NULL
for(i in 1:500){
Ne<-runif(1,100000,5000000)
r<-4*1
theta<-1000000*4*Ne*1e-9
x<-ms(nsam=22, nreps=1, opts=paste("-t",theta))#"-r",r,"1000"))
data<-c(theta,Ne,as.numeric(strsplit(x[3]," ")[[1]][2]))
data
tab<-rbind(tab,data)
print(i)
}
plot(tab[,2]~tab[,3])
install.packages("devtools")
library(devtools)
ls
ls
library(devtools)
library(help=devtools)
?build
build("PipeMaster")
rm
(list=
ls
())
rm(list=ls())
list.files()
x<-list.files()
x
package.skeleton("PipeMaster",list=x)
x
?package.skeleton("PipeMaster",x)
package.skeleton("PipeMaster",code_files=x)
package.skeleton("PipeMaster")
library(devtools)
library(devtools)
install_github("gehara/PipeMaster")
install_github("gehara/PipeMaster")
fasta2ms<-function(path.to.fasta,fasta.files,write.file=T){
setwd(path.to.fasta)
ms.out<-list()
for(u in 1:length(fasta.files)){
fas<-read.dna(file=fasta.files[u], format="fasta")
fas<-as.character(fas)
bin<-NULL
pos<-NULL
if(ncol(fas)==0){
stop(paste(fasta.files[u],"has 0 base pairs! Check the alignment"))
}
for(i in 1:ncol(fas)){
a<-length(grep("a",fas[,i]))
c<-length(grep("c",fas[,i]))
g<-length(grep("g",fas[,i]))
t<-length(grep("t",fas[,i]))
n<-length(grep("n",fas[,i]))
gap<-length(grep("-",fas[,i]))
if(nrow(fas) %in% c(a,c,g,t)){
} else if (gap>0){
} else if(n>0){
} else {bin<-cbind(bin,fas[,i])
pos<-c(pos,i)
}
}
pos<-pos/ncol(fas)
for(j in 1:ncol(bin)){
a<-length(grep("a",bin[,j]))/nrow(bin)
c<-length(grep("c",bin[,j]))/nrow(bin)
g<-length(grep("g",bin[,j]))/nrow(bin)
t<-length(grep("t",bin[,j]))/nrow(bin)
bases<-c(a,c,g,t)
names(bases)<-c("a","c","g","t")
base<-which.max(bases)
bin[,j]<-gsub(names(base),0,bin[,j])
bases<-bases[-base]
for(i in 1:3){
bin[,j]<-gsub(names(bases[i]),1,bin[,j])
}
}
seqs<-NULL
for(i in 1:nrow(bin)){
seqs<-c(seqs,paste(bin[i,],collapse=""))
}
if(write.file==T){
write(file=paste(fasta.files[u],".ms",sep=""),paste("ms",nrow(fas),1))
write(file=paste(fasta.files[u],".ms",sep=""),"//",append=T)
write(file=paste(fasta.files[u],".ms",sep=""),paste("segsites:",ncol(bin)),append=T)
write(file=paste(fasta.files[u],".ms",sep=""),paste("positions:   ",paste(pos,collapse="    ")),append=T)
write(file=paste(fasta.files[u],".ms",sep=""),seqs,sep="\n",append=T)
}
if(write.file==F){
ms.out[[u]]<-paste("ms",nrow(fas),1)
ms.out[[u]]<-c(ms.out[[u]],paste("//"))
ms.out[[u]]<-c(ms.out[[u]],paste("segsites:",ncol(bin)))
ms.out[[u]]<-c(ms.out[[u]],paste("positions:   ",paste(pos,collapse="    ")))
ms.out[[u]]<-c(ms.out[[u]],paste(seqs,sep="\n"))
}
}
if(write.file==F){
return(ms.out)
}
}
fasta2ms(path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
fasta2ms(path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta", fasta.files = list.files())
library(ape)
fasta2ms(path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta", fasta.files = list.files())
ss<-list(NULL)
OA.ss<-list(NULL)
list.files()
fasta.files = list.files()
grep(fasta.files,".ms")
grep(".ms",fasta.files)
fasta.files[grep(".ms",fasta.files)]
fasta.files<-fasta.files[grep(".ms",fasta.files)]
fasta.files
fasta.files = list.files()
fasta.files<-fasta.files[-grep(".ms",fasta.files)]
fasta.files
u<-1
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
library(PopGenome)
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
ss[[u]]
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within/as.numeric(model$loci[u,2])
pi.within<-ss[[u]]@nuc.diversity.within
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D
ss[[u]]@Fu.Li.D
ss[[u]]@Fu.Li.F
is.na(ss[[u]]@Tajima.D)
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
ss[[u]]@Fu.Li.F
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
OA.ss[[u]]
ss<-list(NULL)
OA.ss<-list(NULL)
ss<-list(NULL)
OA.ss<-list(NULL)
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
OA.ss[[u]]
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
}
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
}
}
OA.ss
ss<-list(NULL)
OA.ss<-list(NULL)
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
#if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
OA.ss
OA.ss[[1]]
OA.ss[[1]][5]
OA.ss[[1]][5]<-NA
OA.ss
OA.ss<-Reduce("+",OA.ss)/3
OA.ss
na.omit(OA.ss)
na.omit
ss<-list(NULL)
OA.ss<-list(NULL)
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
#if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
na.omit(OA.ss)
OA.ss[[1]][5]<-NA
na.omit(OA.ss)
na.omit(OA.ss)
na.omit(OA.ss)
na.omit(OA.ss)
OA.ss<-Reduce("+",na.omit(OA.ss))/3
OA.ss
rowMeans(do.call(cbind, OA.ss), na.rm = TRUE)
OA.ss
OA.ss<-list(NULL)
for(u in 1:length(fasta.files)){
ss[[u]]<-readMS(paste(fasta.files[u],".ms",sep=""), big.data = F)
#if(overall.SS==T){
ss[[u]]<-neutrality.stats(ss[[u]],FAST=T)
ss[[u]]<-diversity.stats(ss[[u]])
s.sites<-ss[[u]]@n.segregating.sites
pi.within<-ss[[u]]@nuc.diversity.within#/as.numeric(model$loci[u,2])
Hap.div<-ss[[u]]@hap.diversity.within
ss[[u]]@Tajima.D[is.na(ss[[u]]@Tajima.D)]<-0
ss[[u]]@Fu.Li.D[is.na(ss[[u]]@Fu.Li.D)]<-0
ss[[u]]@Fu.Li.F[is.na(ss[[u]]@Fu.Li.F)]<-0
Taj.D<-ss[[u]]@Tajima.D
Fu.Li.D<-ss[[u]]@Fu.Li.D
Fu.Li.F<-ss[[u]]@Fu.Li.F
OA.ss[[u]]<-cbind(s.sites,pi.within,Hap.div,Taj.D,Fu.Li.D,Fu.Li.F)
}
OA.ss
rowMeans(do.call(cbind, OA.ss), na.rm = TRUE)
colMeans(do.call(cbind, OA.ss), na.rm = TRUE)
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
OA.ss
OA.ss[[1]][5]<-NA
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
OA.ss
(1.194935+-1.069045)/2
(1.194935+(-1.069045))/2
OA.ss[[2]][5]<-NA
OA.ss[[3]][5]<-NA
colMeans(do.call(rbind, OA.ss), na.rm = TRUE)
library(devtools)
install_github("gehara/PipeMaster")
install_github("gehara/PipeMaster")
install_github("gehara/PipeMaster")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
library(ggplot2)
library(abc)
library(phyclust)
library(ape)
library(PopGenome)
library(e1071)
library(pegas)
library(bigmemory)
library(PipeMaster)
setwd("~/Dropbox/Tese_Derma/ABC")
FE<-dget("FE.txt")
FE2<-dget("FE2.txt")
FE2BN<-dget("FE2BN.txt")
IS<-dget("IS.txt")
ISd<-dget("ISd.txt")
ISBN<-dget("ISBN.txt")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
IS
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
observed.sumstat(IS,path.to.fasta = "/home/marcelo/Dropbox/Tese_Derma/fasta")
?single.pop.demog
library(PipeMaster)
?single.pop.demog
3776.18+3618.37+846.23+2586.83+1870.55+73.86
12772.02/58671.56
87000*.21
87000-18270
68730
68730/12
5727.5
5727.5-2000
1835*2
5727.5-3670
5727.5-1400-2000
87000-8907
(87-77)*0.22
87000-8907-2200
75893/12
PopPlanner()
