% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/obs.sfs.R
\name{obs.sfs}
\alias{obs.sfs}
\title{Observed Site Frequency Spectrum from FASTA or PHYLIP Data}
\usage{
obs.sfs(
  model,
  path.to.fasta = NULL,
  path.to.phylip = NULL,
  pop.assign,
  one.snp = FALSE,
  folded = FALSE
)
}
\arguments{
\item{model}{A model object built by the main.menu function. Any model with the same number of
populations as your data will work (used for consistency checks).}

\item{path.to.fasta}{Path to the folder containing FASTA alignments (.fas files).
Invariable sites must be included. Alignments must contain phased data.
Either path.to.fasta or path.to.phylip must be provided.}

\item{path.to.phylip}{Path to a multi-locus sequential PHYLIP file. Each locus block starts
with a "ntax nchar" header followed by ntax sequence lines. Alternative
to path.to.fasta for datasets with many loci.}

\item{pop.assign}{A two-column data frame with sample names in the first column and population
numbers in the second column. Numbers should match population ordering in the model.}

\item{one.snp}{Logical. If TRUE, one segregating site is randomly sampled per locus before
computing the SFS. This reduces variance inflation caused by linkage among
sites within the same locus. Recommended for short loci where recombination
is negligible. Default is FALSE.}

\item{folded}{Logical. If TRUE the SFS will be folded (1-pop only). Default is FALSE.}
}
\value{
A one-row data frame with SFS bins as columns. Column names follow sim.sfs() convention:
        sfs_0, sfs_1, ... for 1-pop; sfs_0_0, sfs_1_0, ... for multi-pop (expand.grid order).
        For 2-pop models, the result has an "sfs_matrix" attribute for use with plot.2D.sfs().
}
\description{
Computes the observed Site Frequency Spectrum (SFS) from empirical alignments.
             For single-population data, returns the 1D SFS. For multi-population data, returns
             the joint SFS. Output format matches sim.sfs() for direct comparison.
             SFS computation is performed natively in C for speed.
}
\note{
Polarization: the major allele (most frequent) is assigned as ancestral (0).
      This differs from true ancestral polarization, so the unfolded SFS may not match
      simulation-based SFS that use true ancestral alleles. Consider using folded=TRUE
      when comparing with such SFS, or when no outgroup is available.
}
\examples{
\dontrun{
# Load a model and population assignment
pop_assign <- read.table("pop_assign.txt", header = FALSE)

# Compute observed 1D SFS from FASTA files
obs <- obs.sfs(model = my_model,
               path.to.fasta = "path/to/fastas",
               pop.assign = pop_assign)

# Compute observed 1D SFS from PHYLIP file
obs <- obs.sfs(model = my_model,
               path.to.phylip = "path/to/data.phy",
               pop.assign = pop_assign)

# Compute folded SFS
obs_folded <- obs.sfs(model = my_model,
                      path.to.fasta = "path/to/fastas",
                      pop.assign = pop_assign,
                      folded = TRUE)
}
}
\author{
Marcelo Gehara
}
