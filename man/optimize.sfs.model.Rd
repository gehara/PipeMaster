% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optimize.sfs.model.R
\name{optimize.sfs.model}
\alias{optimize.sfs.model}
\title{Optimize a model for SFS simulation by downsampling to uniform sample sizes}
\usage{
optimize.sfs.model(model, target = NULL)
}
\arguments{
\item{model}{A model object built by the main.menu function.}

\item{target}{Optional numeric vector of per-population target sample sizes.
Length must equal the number of populations. If NULL (default), the optimal
targets are found automatically.}
}
\value{
A modified model object with uniform sample sizes across all loci,
  ready for use with \code{sim.sfs}.
}
\description{
Analyzes the per-locus, per-population sample sizes in a model object
  and finds the optimal downsampling scheme that removes individuals and loci while
  maximizing the total amount of retained data. This ensures all loci have uniform
  sample sizes, which is required for SFS-based inference with tools like
  fastsimcoal2, dadi, and moments.

  The optimization maximizes the score: n_retained_loci * total_samples_per_locus.
  A locus is retained only if all its per-population sample sizes meet or exceed
  the target thresholds. Retained loci are then downsampled to the target sizes.
}
\examples{
\dontrun{
data("A_piscivorus", package = "PipeMaster")

# Automatic optimization
Is_sfs <- optimize.sfs.model(Is)

# Manual target: keep loci with at least 40 in pop1 and 14 in pop2
Is_manual <- optimize.sfs.model(Is, target = c(40, 14))

# Then simulate SFS
sim.sfs(model = Is_sfs, nsim.blocks = 1, block.size = 100,
             path = tempdir(), output.name = "test")
}
}
\author{
Marcelo Gehara
}
