% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim.sfs.R
\name{sim.sfs}
\alias{sim.sfs}
\title{Simulate Site Frequency Spectra}
\usage{
sim.sfs(
  model,
  use.alpha = FALSE,
  nsim.blocks = 5,
  block.size = 1000,
  path = getwd(),
  output.name = "model",
  append.sims = FALSE,
  mu.rates = NULL,
  one.snp = FALSE,
  folded = FALSE,
  ncores = 1
)
}
\arguments{
\item{model}{A model object built by the main.menu function.}

\item{use.alpha}{Logical. If TRUE the most recent population size change will be exponential. If FALSE sudden demographic changes. Default is FALSE.}

\item{nsim.blocks}{Number of blocks to simulate. The total number of simulations is: nsim.blocks x block.size (x ncores when ncores > 1).}

\item{block.size}{Simulations are performed in blocks. This argument defines the size of the block in number of simulations, i.e. how many simulations to run per block.
A block of 1000 will work for most cases. Increase the total number of simulations with nsim.blocks argument.}

\item{path}{Path to write the output. By default outputs will be saved in the working directory.}

\item{output.name}{String. The prefix of the output names. Default is "model".}

\item{append.sims}{Logical. If TRUE simulations will be appended in the last output. Default is FALSE.}

\item{mu.rates}{List. Distribution to sample the mutation rates. The first element of the list should be the name of the distribution as a character string.
The second element of the list must be the number of loci. The following elements are the parameters of the distribution.
Ex.: mu.rates = list("rtnorm", 1000, 1e-9, 1e-9, 0). If NULL, rates are sampled from the model priors. Default is NULL.}

\item{one.snp}{Logical. If TRUE, one segregating site is randomly sampled per locus before
computing the SFS. This reduces variance inflation caused by linkage among
sites within the same locus. Recommended for short loci where recombination
is negligible. Default is FALSE.}

\item{folded}{Logical. If TRUE the SFS will be folded. Default is FALSE.}

\item{ncores}{Number of cores for parallel execution. When ncores > 1, separate R worker processes are spawned. Default is 1.}
}
\value{
Writes SIM_SFS_{output.name}.txt to the path directory. The file contains a header row followed by one row per replicate, with parameter values (including mean.rate and sd.rate) and SFS bins.
}
\description{
This function simulates the Site Frequency Spectrum (SFS) using the built-in
             coalescent simulator (ms/msABC). SFS computation is performed natively in C for speed.
             For single-population models, it outputs the 1D SFS (unfolded or folded) summed across loci.
             For multi-population models, it computes the joint SFS from segregating sites,
             returning the flattened multi-dimensional array (e.g., (n1+1)*(n2+1) entries for 2 pops).
             Suitable for inference with fastsimcoal2, dadi, moments, etc.
}
\examples{
\dontrun{
# Load example demographic models
data("A_piscivorus", package = "PipeMaster")

# Optimize model for uniform sample sizes
Is_opt <- optimize.sfs.model(Is)

# Quick test run (small block size, single core)
tmpdir <- tempdir()
sim.sfs(model = Is_opt,
        nsim.blocks = 1,
        block.size = 10,
        path = tmpdir,
        use.alpha = FALSE,
        output.name = "test_sfs",
        ncores = 1)

# Read simulated SFS
sim.data <- read.table(file.path(tmpdir, "SIM_SFS_test_sfs.txt"), header = TRUE)
head(sim.data)

# Folded SFS
sim.sfs(model = Is_opt,
        nsim.blocks = 1,
        block.size = 10,
        path = tmpdir,
        use.alpha = FALSE,
        output.name = "test_sfs_folded",
        folded = TRUE,
        ncores = 1)
}
}
\author{
Marcelo Gehara
}
